<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css"   href="./CSS/style.css">
    <link rel="shortcut icon" href="#" />
    <title>To do list</title>
</head>
<body>

    <div class = "container">
        <h1>To Do List</h1>
        <h2></h2>
        <div class="tab">
          </div>
           
              <container id="content">
                <input type="text" id="input">
                <button class="button button1" id="newTask">Add task</button>
                <ul id="myList">
                  
                </ul>
              </container>
              
        </div>
    </div>    

    <script>
let todo = document.getElementById("input");
document.getElementById("newTask").onclick = function(evt){

  let body = {
    todo: todo.value
  }
  let cfg = {
    method: "post",
    headers: {
      "content-type": "application/json"
    },
    body:JSON.stringify(body)
  }
  fetch("/item", cfg).then(resp => {
                console.log(resp.status)
            })
}

let listContainer = document.getElementById("myList");

loadData();

async function loadData(){

let cfg = {
  method: "get",
  
}
try{
  let response = await fetch ("/todoItem", cfg);
  let data = await response.json();
  console.log(data);

  for(let todoData of data.rows){
    let div = document.createElement("div");
    let html =`
    <h2>${todoData.todo}</h2>
    <ul>
      <button id="delBtn">Delete Task</button>
        `
        div.innerHTML = html;
        listContainer.appendChild(div);
        document.getElementById("delBtn").onclick = function(evt){
          console.log("deleted");
          let body={
            todo: todo.value
          }
          let cfg = {
            method: "post",
            headers: {
              "content-type": "application/json"
            },
            body:JSON.stringify(body)
          }
          fetch("/delTodo", cfg).then(res =>{
            console.log(res.status)
          })
        }
    
  }
}catch(err){
  
}
}

      
    </script>
    
</body>
</html>
